<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>

  <head>
    <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
      <title>CRM0207 Create Asset Оrder | ERP.net Domain Model </title>
      <meta name="viewport" content="width=device-width">
      <meta name="title" content="CRM0207 Create Asset Оrder | ERP.net Domain Model ">
    
    
      <link rel="shortcut icon" href="../favicon.ico">
      <link rel="stylesheet" href="../styles/docfx.vendor.min.css">
      <link rel="stylesheet" href="../styles/docfx.css">
      <link rel="stylesheet" href="../styles/main.css">
      <meta property="docfx:navrel" content="../toc.html">
      <meta property="docfx:tocrel" content="../toc.html">
    
    <meta property="docfx:rel" content="../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>

        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>

              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>

        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">

        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        <div class="article row grid">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="crm0207-create-asset-оrder">CRM0207 Create Asset Оrder</h1>

<h2 id="basic-information">Basic Information</h2>
<table>
<thead>
<tr>
<th style="text-align: left;">Module</th>
<th>Crm.Invoices</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Code</td>
<td>CRM0207</td>
</tr>
<tr>
<td style="text-align: left;">Parent Document</td>
<td>Invoice</td>
</tr>
<tr>
<td style="text-align: left;">Sub-document</td>
<td>AssetOrder</td>
</tr>
<tr>
<td style="text-align: left;">Full Name</td>
<td>Create Asset Оrder</td>
</tr>
<tr>
<td style="text-align: left;">Status</td>
<td><a class="xref" href="https://erpnetdocs.github.io/tech/advanced/document-flow/generation-procedures.html">ACTIVE</a></td>
</tr>
<tr>
<td style="text-align: left;">Deterministic</td>
<td><a href="xref:deterministic-generations">YES</a></td>
</tr>
<tr>
<td style="text-align: left;">Supports Transitional Documents</td>
<td><a href="xref:transitional-documents">NO</a></td>
</tr>
<tr>
<td style="text-align: left;">Replaces</td>
<td>GenerateAssetOrder</td>
</tr>
<tr>
<td style="text-align: left;">Orphan Rows</td>
<td>Forbid</td>
</tr>
<tr>
<td style="text-align: left;">Introduced In Version</td>
<td>2018.2</td>
</tr>
<tr>
<td style="text-align: left;">Date of Suspension</td>
<td>-</td>
</tr>
</tbody>
</table>
<h2 id="business-logic">Business Logic</h2>
<p>The generation procedure is activated when in the Invoice lines there are assets (assets are products with Product.ProductType.IsFixedAsset = true). For each such product, its corresponding fixed asset is found, and for all the found assets, an Asset Order is created in the Fixed Assets module for their retirement.</p>
<p>The AssetOrder header is created as follows:</p>
<pre><code>AssetOrder.Operation = Sale
</code></pre>
<p>The rest of the Document table attributes are filled in as described in <a href="../reference/standard-document-attributes.html">Standard Document Attributes</a>.</p>
<h2 id="fulfillments">Fulfillments</h2>
<table>
<thead>
<tr>
<th style="text-align: left;">Name</th>
<th>InvoiceLineToAssetOrderLine</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Parent Entity</td>
<td>InvoiceLine</td>
</tr>
<tr>
<td style="text-align: left;">Child Entity</td>
<td>AssetOrderLine</td>
</tr>
<tr>
<td style="text-align: left;">Parent / Child Relationship</td>
<td>AssetOrderLine.ParentDocument = Invoice;AssetOrderLine.ParentLineNo = InvoiceLine.LineNo</td>
</tr>
</tbody>
</table>
<h2 id="metrics"><a href="../reference/metrics.html">Metrics</a></h2>
<table>
<thead>
<tr>
<th style="text-align: left;">Fulfillment Name</th>
<th style="text-align: center;">Metric Name</th>
<th style="text-align: center;">Measurement Unit</th>
<th style="text-align: left;">Parent Value</th>
<th style="text-align: left;">Child Value</th>
<th style="text-align: left;">New Record</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">InvoiceLineToAssetOrderLine</td>
<td style="text-align: center;">MQuantity</td>
<td style="text-align: center;">InvoiceLine.QuantityUnit</td>
<td style="text-align: left;">InvoiceLine.Quantity</td>
<td style="text-align: left;">AssetOrderLine.Quantity</td>
<td style="text-align: left;">YES</td>
</tr>
<tr>
<td style="text-align: left;">InvoiceLineToAssetOrderLine</td>
<td style="text-align: center;">MLineAmount</td>
<td style="text-align: center;">Invoice.DocumentCurrency</td>
<td style="text-align: left;">InvoiceLine.AssetValue</td>
<td style="text-align: left;">AssetOrderLine.AssetValue</td>
<td style="text-align: left;">YES</td>
</tr>
</tbody>
</table>
<p>The generation includes only Invoice Lines which product has value and which is a fixed asset and which quantity is not 0. For each of those lines, its corresponding fixed asset is found (<strong>Asset</strong>) and its sale value is defined <strong>(AssetValue)</strong>. The <strong>Asset</strong> is defined by an asset with the same code as the product (Asset.Code == InvoiceLine.Product.PartNumber).
If there are products for which no asset is found - the generation breaks and throws an error:</p>
<pre><code>&gt; Cannot find a record with Asset Code '{Product.PartNumber}' in the Assets table.
</code></pre>
<p>The <strong>AssetValue</strong> is defined as follows: the LineAmount of the InvoiceLine is summed up with the amounts of all additional amounts where AddToLine == true.</p>
<p>If the Quantity in the row is -1, the generation procedure breaks and throws an error:</p>
<pre><code>&gt; Line {LineNo} of {DocumentText} has invalid quantity of {Quantity}. The generated document is Asset Order for sale and the quantity cannot be negative.
</code></pre>
<p>The AssetOrder lines are generated according to the data of the unfulfilled quantities and amounts. For each InvoiceLine from the Invoice, which product is fixed asset and quantity is not zero, <strong>REMAINING(MQuantity)</strong> and <strong>REMAINING(MLineAmount)</strong> are defined. If at least one of them is not 0, a new AssetOrderLine is created as follows:</p>
<pre><code>AssetOrderLine.Asset = Asset AssetOrderLine.AssetValue = REMAINING(MLineAmount) AssetOrderLine.AssetValueCurrency = InvoiceLine.Invoice.DocumentCurrency AssetOrderLine.Quantity = REMAINING(MQuantity) AssetOrderLine.ParentLineNo = InvoiceLine.LineNo 
AssetOrderLine.ParentDocument = Invoice
</code></pre>

</article>
          </div>

          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/ErpNetDocs/model/blob/master/generations/CRM0207.md/#L1" class="contribution-link">Edit this page</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In this article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>

      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
      
      <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>

    <script type="text/javascript" src="../styles/docfx.vendor.min.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
  </body>
</html>
