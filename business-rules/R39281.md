---
erp.type: business-rule  
erp.entity: Crm.Presales.Offers  
---

# R39281 Offers - Set Customer From To Party
+------------------+------------------------------------------------------------------------------------------------+
| **Code**         | R39281                                                                                         |
+------------------+------------------------------------------------------------------------------------------------+
| **Entity**       | @Crm.Presales.Offers                                                                           |
+------------------+------------------------------------------------------------------------------------------------+
| **Name**         | SetCustomerFromToParty                                                                         |
+------------------+------------------------------------------------------------------------------------------------+
| **Attribute**    | Customer                                                                                       |
+------------------+------------------------------------------------------------------------------------------------+
| **Layer**        | Back-End                                                                                       |
+------------------+------------------------------------------------------------------------------------------------+
| **Events**       | Releasing +                                                                                    |
+------------------+------------------------------------------------------------------------------------------------+
| **Priority**     | Normal                                                                                         |
+------------------+------------------------------------------------------------------------------------------------+
| **Modify**       | YES                                                                                            |
+------------------+------------------------------------------------------------------------------------------------+
| **Action**       | If (Customer == NULL) && (ToParty != NULL):<br>                                                |
|                  |    Search for an existing Customer record where:<br>                                           |
|                  |    • Customer.Party == Offer.ToParty<br>                                                       |
|                  |    • Customer.IsActive == TRUE<br>                                                             |
|                  |    • Customer.EnterpriseCompany == Offer.EnterpriseCompany OR Customer.EnterpriseCompany == NULL 
|                  |    • Customer.FromDate == NULL OR Customer.FromDate <= Offer.DocumentDate<br>                  |
|                  |    • Customer.ThruDate == NULL OR Customer.ThruDate >= Offer.DocumentDate<br></br>             |
|                  |   If a matching Customer is found:<br>                                                         |
|                  |     • Set the first found Customer to the Offer's Customer field.<br></br>                     |
|                  |   Else:<br>                                                                                    |
|                  |     • Create a new Customer record where:<br>                                                  |
|                  |       • Customer.Party == Offer.ToParty<br>                                                    |
|                  |       • Customer.FromDate = TODAY<br>                                                          |
|                  |       • Customer.EnterpriseCompany = Offer.EnterpriseCompany<br>                               |
|                  |       • Customer.DefaultCurrency = Offer.EnterpriseCompany.BaseCurrency<br>                    |
|                  |       • Customer.CreditLimit = Offer.EnterpriseCompany.DefaultCustomerCreditLimitBase<br>      |
|                  |       • Customer.IsActive = TRUE<br>                                                           |
|                  |       • Customer.AllowUseAsPrimaryCustomer = TRUE<br>                                          |
|                  |       • Customer.AllowUseAsShipToCustomer = FALSE<br>                                          |
|                  |       • Other customer fields are set to NULL or to their default values<br></br>              |
|                  |    • Then set the new Customer to the Offer's Customer field                                   |
+------------------+------------------------------------------------------------------------------------------------+
| **Description**  | The rule checks for an existing valid Customer record based on the Offer’s ToParty and         |
|                  | EnterpriseCompany when an Offer is approved (system state set to Released or higher).<br>      |
|                  | If there is an existing valid Customer record, it is assigned to the Offer.<br>                |
|                  | If no such record is found, a new Customer is created and then assigned to the Offer.<br>      |
|                  | This eliminates the need for manual customer assignment or creation by the user.               |
+------------------+------------------------------------------------------------------------------------------------+
| **Message**      | \-                                                                                             |
+------------------+------------------------------------------------------------------------------------------------+
| **Version**      | Introduced: v.26.2                                                                             |
+------------------+------------------------------------------------------------------------------------------------+
| **Revocable**    | NO                                                                                             |
+------------------+------------------------------------------------------------------------------------------------+

*\* For more information about the Business Rules Documentation Template and a short explanation of each column, see  
topic [System Business Rules](../templates/template-description-system-business-rules.md).*
