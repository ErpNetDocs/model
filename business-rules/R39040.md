---
erp.type: front-end-business-rule
erp.entity: Finance.Accounting.AccountingVoucherLines
---

# R39040 Accounting Voucher Lines: Rewrite LineNewCurrencyIsValid rule and update it to respect Limit to Base Currency
| Name | Value |
| ---- | ----- |
| Code | R39040 |
| Entity | @Finance.Accounting.AccountingVoucherLines |
| Name | LineNewCurrencyIsValid |
| Attribute | AccountingVoucherLines.Currency |
| Layer | Front-End |
| Events | AttributeChanged (Currency) |
| Priority | Normal |
| Modify | NO |
| Applicable Legislations | ALL // no condition needed |
| Action | Validates that: <br> If (Account != null) AND (Account.Currency !=  null) AND (Account.LimitToBaseCurrency = False) THEN (Currency == Account.Currency) <br> If (Account != null) AND (Account.LimitToBaseCurrency = TRUE) THEN (Currency = AccountingVoucher.EnterpriseCompany.BaseCurrency OR AccountingVoucher.EnterpriseCompany.ReportingCurrency) |
| Description| If the Account specified in Voucher Lines does not have the 'Limit to base currency' enabled, then the Currency in the Accounting Voucher Line must match the specified Account Currency (if any). <br> However, if the 'Limit to base currency' is enabled, then the Currency used in the Accounting Voucher Line must be either the Enterprise Company's Base Currency or Reporting Currency. |
| Message | |
| Version | Introduced: 2026 |
| Revocable | YES |
